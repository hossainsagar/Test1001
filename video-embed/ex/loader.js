!function(){"use strict";const e=9/16;let t;!function(e){e.SET_UTK="SET_UTK";e.SET_PAGE_META="SET_PAGE_META";e.SET_CURRENT_TIME="SET_CURRENT_TIME";e.SET_PLAYBACK_RATE="SET_PLAYBACK_RATE";e.UPDATE_DISPLAY_OPTIONS="UPDATE_DISPLAY_OPTIONS";e.SET_PLAYER_STATUS="SET_PLAYER_STATUS";e.CONFIRM_VISIBLE="CONFIRM_VISIBLE";e.CTA_SKIPPED="CTA_SKIPPED";e.CTA_CLICKED="CTA_CLICKED";e.FORM_SKIPPED="FORM_SKIPPED";e.FORM_SUBMITTED="FORM_SUBMITTED";e.VIDEO_LOADED="VIDEO_LOADED";e.PLAYER_LOADED="PLAYER_LOADED";e.PLAYER_READY="PLAYER_READY";e.PLAYER_PLAY="PLAYER_PLAY";e.PLAYER_PAUSE="PLAYER_PAUSE";e.PLAYER_ENDED="PLAYER_ENDED";e.PLAYER_PROGRESS="PLAYER_PROGRESS";e.PLAYER_TIME_UPDATE="PLAYER_TIME_UPDATE";e.PLAYER_SHOW_OVERLAY="PLAYER_SHOW_OVERLAY";e.PLAYER_ORPHANED="PLAYER_ORPHANED";e.PLAYER_ERROR="PLAYER_ERROR";e.PLAYER_ANALYTICS_EVENTS="PLAYER_ANALYTICS_EVENTS";e.PLAYER_SECONDS_VIEWED="PLAYER_SECONDS_VIEWED";e.TRACKED_PLAY="TRACKED_PLAY"}(t||(t={}));const o=["region","posterUrl","playButtonColor","play_button_color","playButtonShape","play_button_shape","preview","richTextPreview","playerType","autoplay","autoPlay","enablePictureInPicture","loop","muted","hiddenControls","hidden_controls","hostApp","renderContext","parentUrl","maxHeight","objectFit","playbackRate"],n=1e3,i="/share/hubspotvideo/",r={INITIAL:"INITIAL",LOADING:"LOADING",READY:"READY",PLAYING:"PLAYING",PAUSED:"PAUSED",ENDED:"ENDED",CONVERSION_ASSET_OVERLAY:"CONVERSION_ASSET_OVERLAY",ERROR:"ERROR"};let s,a;!function(e){e.FORM="FORM";e.CTA="CTA"}(s||(s={}));!function(e){e.PRE="PRE";e.POST="POST";e.CUSTOM="CUSTOM"}(a||(a={}));const l={DEFAULT:"hsvideo-mux",VIDEOJS_RAW_URL:"videojs-raw-url",HTML5:"html5",IN_APP_PREVIEW:"inAppPreview",EDITOR_PREVIEW:"editorPreview",RICH_TEXT_PREVIEW:"richTextPreview",ACADEMY_IN_APP:"academy"},d="VIDEO_PLAYER_ENV",c="-qa.js",u=[".hubspotqa.com",".hubspotvideoqa.com",".hsappstatic.net"],h=/http(s?):\/\/(app|local)(-\w+)?.hubspot(qa)?.com/;let p=!1;function f(e,t=!0){if(!t&&p)return null;try{return localStorage.getItem(e)}catch(e){p=!0;return null}}const m=()=>window[d];function g(){return m()?"local"===m():"local"===f(d)||!!window.location.search.includes("_hsVideoEnv=local")}function E(){if(Ee()||"qa"===f(d))return!0;if(m())return"qa"===m();const e=V();return u.some((e=>window.location.hostname.endsWith(e)))||e&&e.endsWith(c)}function y(e={}){const t=e.region||ye(),o=t?`-${t}`:"";if(e&&"prod"===e.env)return`https://${g()?"local":"play"}.hubspotvideo.com`;if(v()&&e.playerType!==l.ACADEMY_IN_APP){if(E()&&!g()&&!ye())return"https://app.hubspotqa.com";if(!e.region&&!e.env)return window.location.origin}if(g())return E()?"https://local.hubspotvideoqa.com":"https://local.hubspotvideo.com";return`https://play${o}.${E()||"qa"===e.env?"hubspotvideoqa.com":"hubspotvideo.com"}`}function b(){return"jasmineRequire"in window}function v(e){return!(b()&&!e)&&Boolean((e||window.location).origin.match(h))}function w(){return Boolean(f("selenium.disable.alarms"))}const A="hs_video_debug";function P(){return!!(g()||window.hsVideoDebug||window.location.search.includes("debug=true"))||"true"===f(A)}function _(...e){if(P()){const t=e.shift();console.log.apply(console,[`[hs-video] ${t}`,...e])}}const I="hs-script-loader",R="/hs/scriptloader/",T=/video-embed\/ex\/loader(-qa)?.js/,S=`${"div.hs-video-widget[data-hsv-embed-id]"}:not([data-hsv-status])`,C="iframe[data-hsv-src]",L="iframe[data-hsv-id][src]";function O(e){return[].slice.call(document.querySelectorAll(e))}function $(e,t){return[].slice.call(e.querySelectorAll(t))}function M(){return O("script[src]").find((e=>T.test(e.src)||e.src.endsWith("/video-embed/static/bundles/loader.js")))}function D(){const e=document.getElementById(I);if(e&&e.src&&e.src.includes(R)){const t=document.createElement("a");t.href=e.src;const o=t.pathname.replace(R,"").replace(".js",""),n=Number(o);if(n>0)return n}return null}function V(){const e=M();return e?e.src:null}function k(e,t=!1){return t?document.querySelector(`[data-hsv-embed-id="${e}"]:not([data-hsv-status])`):document.querySelector(`[data-hsv-embed-id="${e}"]`)}function N(){return"interactive"===document.readyState||"complete"===document.readyState}const Y=1e4;function x(e,t){const o=document.createElement("script");return new Promise(((n,i)=>{let r=!1;o.onload=()=>{r=!0;n()};o.onerror=()=>i(new Error(`loadScript failed for: ${e}`));o.src=e;t&&Object.keys(t).forEach((e=>o.setAttribute(e,t[e])));document.getElementsByTagName("head")[0].appendChild(o);setTimeout((()=>{r||i(new Error(`loadScript timed out for: ${e}`))}),Y)}))}function q(e,t={}){e instanceof HTMLElement&&Object.assign(e.style,t)}function F(e,t){t.startsWith(".")||(t=`.${t}`);for(;e&&e.parentElement;){if(e.parentElement.matches&&e.parentElement.matches(t))return e.parentElement;e=e.parentElement}return null}function j(e,t){return Boolean(F(e,t))}function U(e){const t=e.getBoundingClientRect();return t.bottom>0&&t.right>0&&t.left<window.innerWidth&&t.top<window.innerHeight}function W(e){const{backgroundColor:t}=getComputedStyle(e);return"transparent"===t||"rgba(0, 0, 0, 0)"===t}function H(e){const t=parseInt(e.substring(1),16);return.2126*(t>>16&255)+.7152*(t>>8&255)+.0722*(t>>0&255)}function B(e){const t=document.createElement("iframe");t.src=`${y()}/video-preloader/${ge()}`;q(t,{display:"none",width:0,height:0,border:"0 none"});_("Created preloader iframe",t);t.addEventListener("load",(()=>{_("Preloader iframe loaded, removing from page.");t.remove();e()}));document.body.appendChild(t)}const K="outpost",G="na1";function Q(e=""){return e&&e!==G?`-${e}`:""}const J=(e="")=>`forms${Q(e)}`,z=(e="")=>`exceptions${Q(e)}`,X=(e=!1)=>e?"hubspotqa.com":"hubspot.com",Z=(e=!1)=>e?"hs-embed-reportingqa.com":"hs-embed-reporting.com",ee=({hublet:e="",isQa:t=!1}={})=>`https://${J(e)}.${X(t)}/${K}`,te=({hublet:e="",isQa:t=!1}={})=>`https://${z(e)}.${Z(t)}/${K}`;function oe(e,...t){let o,n=0;e=e||{};for(;n<t.length;)if(t[n]){for(o in t[n])t[n].hasOwnProperty(o)&&(e[o]=t[n][o]);n++}else n++;return e}function ne(e,t){if(!t)return!1;for(let o=0;o<e.length;o++)if(t.indexOf(e[o])>-1)return!0;return!1}function ie(e){let t="";for(const o in e)e.hasOwnProperty(o)&&(t+=`${o}=${e[o]};`);return t}const re=({isEmbedApp:e=!1,env:t="PROD",hublet:o=""})=>{const n="PROD"!==t;return e?te({isQa:n,hublet:o}):ee({isQa:n,hublet:o})};class se{constructor(e,t){t=t||{};e||console.warn("The projectName parameter is required");this.projectName=e;this.env=(t.env||"PROD").toUpperCase();this.hublet=t.hublet||"";this.isEmbedApp=t.isEmbedApp||!1;this.level=(t.level||"ERROR").toUpperCase();this.disabled=t.disabled||!1;this.baseUrl=t.baseUrl||re({isEmbedApp:this.isEmbedApp,env:this.env,hublet:this.hublet});this.tags=t.tags||{};this.cookies=t.cookies||{};this.user=t.user||{}}bindToWindow(e=[],t=[]){e.length<1?console.warn("You need to specify allowlisted domains when binding to window errors or you will catch all page errors"):window.onerror=(o,n,i,r,s)=>{n&&ne(e,n)&&!ne(t,s.message)&&"script error"!==o.toLowerCase()&&this.sendReport("error",o,n,s)}}report(e,t,o={}){if(e){o.silent&&console.error(e);this.sendReport("error",e.message,e.fileName,e,t)}}reportMessage(e,t,o={}){if(e){o.silent&&console.error(e);this.sendReport("info",e,window.location.href,void 0,t)}}debug(e,t){if(e&&"DEBUG"===this.level){console.debug(e);this.sendReport("debug",e.message,e.fileName,e,t)}}addTags(e){oe(this.tags,e)}addCookies(e){oe(this.cookies,e)}addUserContext(e){oe(this.user,e)}sendReport(e,t,o,n,i){if(this.disabled){console.warn("Not reporting error to Outpost because logging is disabled");return}o=o||(window.document.currentScript?window.document.currentScript.src:null)||window.location.href;const r=this.buildReport(e,t,o,n,i),s=new Image,a=encodeURIComponent(JSON.stringify(r));s.src=`${this.baseUrl}/${this.projectName}/error.gif?report=${a}`;s.onload=()=>{console.log(`Completed reporting error to ${this.projectName}`)}}buildReport(e,t,o,n,i={}){const r=n?n.name:"Message";let s;s=n&&n.message?n.message.substring(0,999):t.substring(0,999);return{culprit:r,message:s,level:e,exception:[{type:r,value:n&&n.stack&&n.stack.substring(0,999)||s,url:o}],request:{url:`${window.location.protocol}//${window.location.host+window.location.pathname}`,queryString:window.location.search.replace(/(^\?)/,""),cookies:ie(this.cookies)},environment:this.env,tags:oe(this.tags),user:this.user,extra:i}}}var ae=se;const le=5;let de,ce=0;function ue(){de||(de=new ae("video-embed",{env:Ee()?"qa":null,debug:P(),tags:{domain:window.location.origin,portalId:ge()||void 0,hublet:ye()||void 0}}));return de}function he(){return!(b()||w()||ce>=le)}function pe(e,t={}){_("Reporting message to outpost",e);if(he()){ue().reportMessage(e,t);ce++}}function fe(e,t={}){_("Reporting error to outpost",e);if(he()){ue().report(e,t);ce++}}function me(){return window.hsVars?window.hsVars:null}function ge(){const e=M();return e&&e.dataset.hsPortalId?Number(e.dataset.hsPortalId):me()?me().portal_id:D()}function Ee(){const e=M();if(e&&e.dataset.hsEnv)return"qa"===e.dataset.hsEnv;const t=me();return!(!t||!t.app_hs_base_url)&&t.app_hs_base_url.includes("hubspotqa.com")}function ye(){const e=M();if(v()){const e=window.location.hostname.split(".")[0];if(e.includes("-"))return e.split("-")[1]}if(e&&e.dataset.hsRegion)return e.dataset.hsRegion;const t=me();if(t&&t.app_hs_base_url){const e=t.app_hs_base_url.split("//")[1].split(".")[0];return e.includes("-")?e.split("-")[1]:null}return null}function be(){const e=M();return e&&e.dataset.hsPageId?Number(e.dataset.hsPageId):me()?me().page_id:null}function ve(){return me()?me().language:null}function we(){return Boolean(window.hsInEditor)}function Ae(){return window.location.pathname.startsWith(i)}const Pe="hs-content-id-";function _e(){let e=null;document.body.classList.forEach((t=>{t.includes(Pe)&&(e=parseInt(t.replace(Pe,""),10))}));return e||null}function Ie(){return window.hsVideoOptions||{}}function Re(){const e={pageUrl:window.location.href,pageTitle:document.title,pageId:be()};Ae()&&(e.pageId=0);if("number"==typeof e.pageId)return e;if(!v())if(_e()){e.pageId=_e();pe("Missing expected hsVars context, parsed pageId from body classname")}else pe("Missing expected hsVars context");return e}function Te(e,t=[]){return Object.keys(e).filter((e=>t.includes(e))).reduce(((t,o)=>Object.assign({},t,{[o]:e[o]})),{})}function Se(e){return Object.values?Object.values(e):Object.keys(e).map((t=>e[t]))}function Ce(e=window.location.search){const t={};"?"===e[0]&&(e=e.substring(1));e.split("&").forEach((e=>{const[o,n]=e.split("=");if(o&&n)try{t[o]=decodeURIComponent(n)}catch(i){_(`Could not decode query param: ${e}`);t[o]=n}}));return t}function Le(e){const t={};Object.keys(e).forEach((o=>{(e[o]||"number"==typeof e[o])&&(t[o]=e[o])}));return Object.keys(t).map((e=>`${e}=${encodeURIComponent(t[e])}`)).join("&")}function Oe(e){return"object"==typeof e&&Object.keys(e).length?`?${Le(e)}`:""}const $e=["type","id","position","overlayDelaySeconds","preventSkip"];function Me(e){return $e.map((t=>e[t]?String(e[t]):"")).join("_")}function De(e){const t=me(),n=t&&"number"==typeof t.page_id?t.page_id:_e(),i=window.location.origin||`${window.location.protocol}//${window.location.hostname}`,r=Object.assign({},Te(e,o),{parentOrigin:i,pageId:n,locale:ve()});r.parentOrigin||pe(`window.location is missing - ${document.documentURI}`);P()&&(r.debug=!0);we()&&(r.playerType=l.EDITOR_PREVIEW);const d=Ce();Ie().hidePosterImage&&(r.hidePosterImage=!0);d._hsVideoForm?e.conversionAsset={type:s.FORM,position:a.PRE,id:d._hsVideoForm}:d._hsVideoCta&&(e.conversionAsset={type:s.CTA,position:a.PRE,id:d._hsVideoCta});"object"==typeof e.conversionAsset&&e.conversionAsset.type&&e.conversionAsset.id&&(r.ca=Me(e.conversionAsset));if(r.playButtonColor){r.playButtonColor=r.playButtonColor.replace("#","");"ffffff"===r.playButtonColor&&delete r.playButtonColor}1===r.playbackRate&&delete r.playbackRate;"100%"===e.height&&("100%"===e.width||e.full_width)&&(r.objectFit="cover");return r}function Ve(e,t,o={},n,i,r){let s="video";if(e&&t){const o=i&&i.playerType===l.ACADEMY_IN_APP;s=v()&&!o?`video/${e}/id/${t}`:`v/${e}/id/${t}`}const a={};if(n){a.hsvid=n;a.t=Date.now();r&&(a.afterPreload=!0)}const d=Oe(a).replace("?","#");return`${y(i)}/${s}${Oe(o)}${d}`}const ke='\n  <div class="hsv-overlay-close" aria-label="Close" role="button" data-action="close"\n       style="position: absolute; display: block; top: 15px; right: 15px; width: 16px; height: 16px; background: transparent; cursor: pointer">\n    <svg viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg" style="position: absolute; top: 0; stroke: white; stroke-width: 2px">\n      <path d="M14.5,1.5l-13,13m0-13,13,13" transform="translate(-1 -1)"></path>\n    </svg>\n    <span style="position: absolute; padding: 20px; border-radius: 100%; top: -12px; left: -12px; background: rgba(255, 255, 255, 0.1)" />\n    <style>\n      .hsv-overlay-close > span { display: none; }\n      .hsv-overlay-close:hover > span { display: block; }\n    </style>\n  </div>\n',Ne=e=>/^\d+$/.test(e);function Ye(e,t){const o=document.createElement("div");o.innerHTML=ke;o.querySelector(".hsv-overlay-close").addEventListener("click",(()=>e()));t.appendChild(o.firstElementChild)}function xe(e,t){return Ne(t.id)?`\n    <div class="hsv-cta-wrapper hsv-overlay" style="position: absolute; display: flex; width: 100%; height: 100%;\n                                        align-items: center; justify-content: center;">\n      <div class="hs-cta-embed hs-cta-simple-placeholder hs-cta-embed-${t.id}">\n        <a target="_blank" rel="noopener noreferrer">\n          <img\n            alt="Video CTA"\n            src="${qe(t.id,e)}"\n          />\n        </a>\n      </div>\n      ${t.preventSkip?"":ke}\n    </div>\n    `:`\n    <div class="hsv-cta-wrapper hsv-overlay" style="position: absolute; display: flex; width: 100%; height: 100%;\n                                        align-items: center; justify-content: center;">\n        <span class="hs-cta-node hs-cta-${t.id}" id="hs-cta-${t.id}">\n          <a target="_blank" rel="noopener noreferrer">\n            <img\n              class="hs-cta-img"\n              id="hs-cta-img-${t.id}"\n              alt="Video CTA"\n              src="${qe(t.id,e)}"\n            />\n          </a>\n        </span>\n        ${t.preventSkip?"":ke}\n      </div>\n    `}function qe(e,t){let o=`//no-cache.${E()?"hubspotqa.com":"hubspot.com"}`;"eu1"===ye()&&(o=E()?"//hubspot-no-cache-eu1-qa.s3.amazonaws.com":"//hubspot-no-cache-eu1-prod.s3.amazonaws.com");return`${o}/cta/default/${t}/${Ne(e)?`interactive-${e}`:e}.png`}function Fe(e,o){const{id:n}=o,i=document.createElement("div");i.innerHTML=xe(e.portalId,o);const r=i.firstElementChild;e.getWrapperEl().append(r);const s=()=>{e.postMessageToPlayer(t.CTA_SKIPPED);r.style.display="none"},a=()=>{e.postMessageToPlayer(t.CTA_CLICKED);r.style.display="none"},l=()=>{r.querySelector(".hsv-overlay-close")||Ye(s,r)},d=r.querySelector(".hsv-overlay-close");d&&d.addEventListener("click",s);const c=()=>{if(!window.hbspt||!window.hbspt.cta){pe("Could not load CTA JS");s();return}window.hbspt.cta._relativeUrls=!0;window.hbspt.cta.canonicalURL=window.location.href;const t={region:ye()||"na1",useNewLoader:!0,enforceTargetIsBlank:!0};E()&&(t.env="qa");e.el.querySelector(".hs-cta-node").addEventListener("click",a);window.hbspt.cta.load(e.portalId,n,t);window.hbspt.cta.loadQueue()},u=()=>{if(!window.__PRIVATE__HubspotCtaClient||"function"!=typeof window.__PRIVATE__HubspotCtaClient.loadCta){pe("Web interactive API not found after load");s();return}const e=r.querySelector(".hs-cta-simple-placeholder");window.hsCtasOnReady=window.hsCtasOnReady||[];window.hsCtasOnReady.push((()=>{window.__PRIVATE__HubspotCtaClient.loadCta({contentId:Number(o.id),options:{openInNewTab:!0,elementToEmbed:e,onNavigate:a}});window.HubSpotCallsToActions&&window.HubSpotCallsToActions.on("onCallToActionFormSubmitted",l)}))};if(Ne(o.id))if(window.__PRIVATE__HubspotCtaClient)u();else{let e=`${window.location.origin}/hs/cta/web-interactives-embed.js`;v()&&(e=E()?"https://js.hubspotqa.com/web-interactives-embed.js":"https://js.hscta.net/web-interactives-embed.js");x(e,{id:"hubspot-web-interactives-loader",crossorigin:"anonymous","data-loader":"hs-scriptloader","data-hsjs-portal":ge(),"data-hsjs-hublet":ye()||"na1"}).then(u).catch((e=>{pe("Failed to load web interactive JS",{errorMessage:String(e)});s()}))}else if(window.hbspt&&window.hbspt.cta)c();else{let e=`${window.location.origin}/hs/cta/cta/current.js`;v()&&(e=E()?"https://js.hubspotqa.com/cta/current.js":"https://js.hscta.net/cta/current.js");x(e).then(c).catch((e=>{console.error("Failed to display CTA",e);pe("Failed to display CTA",{errorMessage:String(e)});s()}))}}let je;function Ue(){if(!je)try{je=window.scrollTo;window.scrollTo=(...e)=>{_("Prevented scrollTo with args:",...e)}}catch(e){_("Failed to patch window.scrollTo to prevent forms auto-scroll",e)}}function We(){if(je){try{window.scrollTo=je}catch(e){_("Failed to un-patch window.scrollTo to restore auto-scroll ability",e)}je=void 0}}const He="hsv-form-wrapper",Be=".hs-submit .hs-button",Ke=155,Ge=9,Qe="Thanks for your response!";function Je(e){return`\n      <div class="hsv-overlay hsv-form-modal" style="position: absolute; top: 0; bottom: 0; left: 0; right: 0;">\n        <div class="${He}" style="height: 100%; overflow-y: auto; padding: 20px 40px; text-align: left">\n          <div class="hsv-form" />\n        </div>\n        ${e.preventSkip?"":ke}\n      </div>\n  `}const ze=(e,t)=>{const o=e.querySelector("form");if(!o){_("Form el not found in onFormReady callback");return}const n=o.querySelector("div.actions");n&&q(n,{margin:0,padding:0});if(!t||"#ffffff"===t)return;"#"!==t[0]&&(t=`#${t}`);const i=H(t)>Ke;try{const o=e.querySelector(`form ${Be}`);if(!o){_("Could not find form submit button to apply color to");return}q(o,{backgroundColor:t,borderColor:t});i&&q(o,{color:"black"})}catch(e){console.error("Failed to update form submit button color",e)}};function Xe(e,o){let n,i=!1,r=!1,s=!1;const{id:l}=o,d=document.createElement("div");d.innerHTML=Je(o);const c=d.firstElementChild;e.getWrapperEl().append(c);const u=c.querySelector(".hsv-form"),h=()=>{We();e.postMessageToPlayer(i?t.FORM_SUBMITTED:t.FORM_SKIPPED,{isLegacyForm:r});c.style.display="none"},p=()=>{e.postMessageToPlayer(t.FORM_SUBMITTED,{isLegacyForm:r});c.style.display="none"},f=()=>{We();s&&p();i=!0;const e=c.querySelector(".submitted-message")||u;c.querySelector(".hsv-overlay-close")||Ye(p,c);const t='\n      <div style="margin-top: 10px; text-align: center">\n        <a data-test-id="form-watch-video" style="cursor: pointer">Watch video</a>\n      </div>\n    ',o=document.createElement("div");o.innerHTML=t;o.querySelector("a").addEventListener("click",(()=>p()));setTimeout((()=>{e.append(o.firstElementChild)}),250)},m=e.el.querySelector(".hsv-overlay-close");m&&m.addEventListener("click",h);const g=()=>{if(window.HubSpotForms){Ue();e.form=window.HubSpotForms.create({formId:l,portalId:e.portalId,env:E()?"qa":null,region:ye(),target:`${e.getPlaceholderSelector()} .hsv-form`,css:"",onFormDefinitionFetchSuccess:e=>{n=e.form;if(n){n.formTypeNumber===Ge&&(r=!0);n.inlineMessage||(s=!0)}},onFormReady:()=>{const t=c.querySelector("form");t&&W(t)&&q(u,{background:"white",padding:"10px 20px"});ze(c,e.options.playButtonColor);if(n.redirectUrl&&o.position!==a.POST){_(`Overriding redirectUrl ${n.redirectUrl} with generic inlineMessage`);e.form.setContext({inlineMessage:Qe,redirectUrl:""})}},getExtraMetaDataBeforeSubmit:()=>({hs_video_id:e.options.id,hs_video_title:e.video?e.video.title:null}),onFormSubmitted:()=>setTimeout(f,0)})}else{pe("Could not load Forms JS");h()}};if(window.HubSpotForms)g();else{x(`//js.${E()?"hsformsqa.net":"hsforms.net"}/forms/embed/v2.js`).then(g).catch((e=>{console.error("Failed to display form",e);pe("Failed to display form",{errorMessage:String(e)});h()}))}}const Ze=[r.INITIAL,r.LOADING,r.READY],et="video-embed-js",tt="hubl-iframe",ot=()=>window.performance.now?window.performance.now():null,nt=(e,t)=>{const o=e.filter((e=>"number"==typeof e.timings[t])).map((e=>e.timings[t]));return o.length?Math.round(Math.min(...o)):null},it=e=>{let t=et;e.some((e=>e.options.renderContext&&e.options.renderContext.startsWith("hubl-iframe")))&&(t=tt);return{embedType:t,embedVersion:1,firstVideoLoadedAt:nt(e,"loadedAfterMs"),firstVideoReadyAt:nt(e,"readyAfterMs"),firstVideoPlayedAt:nt(e,"playedAfterMs"),numHsVideos:e.length,numAutoplay:e.filter((e=>e.options.autoplay)).length,numInitiallyVisible:e.filter((e=>e.initiallyVisible)).length,numInteractedWith:e.filter((e=>!Ze.includes(e.status))).length,secondsOfVideoPlayed:e.reduce(((e,t)=>e+(t.timings.secondsViewed||0)),0)}},rt="hsv",st="ca",at=["id","width","height"],lt={fullWidth:"full_width"},dt=[".slick-slide.slick-cloned",".swiper-slide-duplicate"],ct=e=>`${e[0].toLowerCase()}${e.slice(1)}`;function ut(e){let t=e.querySelector("img[data-hsv-id]");t||(t=e.querySelector("iframe[data-hsv-src]"));if(!t)return null;const o=Object.assign({},t.dataset),n={embedId:e.dataset.hsvEmbedId};Object.keys(o).forEach((e=>{let t=o[e];(e=ct(e.replace(rt,"")))in lt&&(e=lt[e]);"true"===t?t=!0:"false"===t?t=!1:at.includes(e)&&(e.includes("%")||Number.isNaN(Number(t))||(t=Number(t)));if(e.startsWith("ca")){e=ct(e.replace(st,""));n.conversionAsset=n.conversionAsset||{};"overlayDelaySeconds"===e&&(t=Number(t));n.conversionAsset[e]=t}else n[e]=t}));return n}function ht(e){return!dt.some((t=>j(e,t)))}function pt(e=document.body){const t=$(e,S).filter((e=>e.querySelector("img[data-hsv-id]"))),o=t.filter(ht);o.length!==t.length&&_(`Found only ${o.length} valid placeholders out of ${t.length} total.`,t);const n=o.map(ut),i={};o.forEach(((e,t)=>{const o=n[t];o&&o.embedId&&(i[o.embedId]={id:o.embedId,el:e,options:o})}));Object.keys(i).length!==n.length&&_(`Found only ${Object.keys(i).length} unique embedIds for ${n.length} placeholders.`,o);return Se(i)}function ft(e=document.body){return $(e,S).filter((e=>e.querySelector(C))).map((e=>({el:e,options:ut(e)})))}class mt{constructor(e,o,i,d){this.status=r.INITIAL;this.confirmedVisible=!1;this.initiallyVisible=!1;this.preloaderIframeLoaded=!1;this.iframeLoaded=!1;this.getWrapperEl=()=>this.el.matches(".hs-video-wrapper")?this.el:this.el.querySelector(".hs-video-wrapper");this.injectPlayer=()=>{const{options:e,placeholderEl:t}=this;if(t.querySelector(C))this.iframeEl=t.querySelector(C);else{if(this.selectIframeElFromPage()){pe("injectPlayer found iframe el on page via selector, not inserting again.");this.replaceIframeFromPage();return}if(!t){pe("injectPlayer cannot find placeholder, no way to render!");return}this.injectIframe(t);t.setAttribute("data-hsv-status","rendered")}if(v()||e.playerType===l.IN_APP_PREVIEW||e.playerType===l.EDITOR_PREVIEW||e.autoplay)this.onConfirmVisible();else{setTimeout((()=>this.confirmRendered()),n);if(window.IntersectionObserver)try{this.setupIntersectionObserver()}catch(e){this.log("Failed to setup IntersectionObserver",e);pe("Failed to setup IntersectionObserver",{err:String(e)});this.onConfirmVisible()}else{pe("Missing IntersectionObserver constructor");this.onConfirmVisible()}}};this.injectIframe=e=>{e.appendChild(this.el);const t=e.querySelector("img[data-hsv-id]");if(t&&t.src){this.el.style.backgroundImage=`url(${t.src})`;this.el.style.backgroundSize="contain";this.el.style.backgroundRepeat="no-repeat";this.el.style.backgroundPosition="center"}this.hidePlaceholderImage()};this.hidePlaceholderImage=()=>{const e=this.placeholderEl.querySelector("img[data-hsv-id]");e&&e.style.setProperty("display","none","important")};this.on=(e,t)=>{this.eventTarget?this.eventTarget.addEventListener(e,t):console.log("Browser does not support EventTarget API, on is a no-op.")};this.trigger=e=>{this.eventTarget&&this.eventTarget.dispatchEvent(e)};this.onConfirmVisible=()=>{const e=this.iframeEl.getAttribute("data-hsv-src");if(e){const[t]=e.split("#"),o=t.split("?");let n=o[0];const i=Ce(o[1]||""),r=Ce();i.parentOrigin=window.location.origin;i.renderContext=this.options.renderContext;r._hsVideoForm&&!i.ca?i.ca=Me({type:s.FORM,position:a.PRE,id:r._hsVideoForm}):r._hsVideoCta&&!i.ca&&(i.ca=Me({type:s.CTA,position:a.PRE,id:r._hsVideoCta}));g()&&(n=n.replace("play","local"));this.iframeEl.src=`${n}?${Le(i)}#hsvid=${this.id}`;this.iframeEl.removeAttribute("data-hsv-src")}else{const e=this.iframeEl.getAttribute("src");if(!e||!/http(s?):/.test(e)){this.hidePlaceholderImage();this.iframeEl.src=this.buildIframeUrl();this.el.style.backgroundImage="none"}}this.status=r.LOADING;this.postMessageToPlayer(t.CONFIRM_VISIBLE);this.confirmedVisible=!0};this.log=(...e)=>{_(`(${this.id})`,...e)};this.id=e;this.portalId=o;this.options=i;this.outgoingMessages=[];this.receivedMessages=[];this.timings={constructedAt:ot()};this.placeholderEl=d||k(this.id,!0);this.el=this.createPlayerIframe();this.iframeEl=this.el.querySelector("iframe");if(window.EventTarget)try{this.eventTarget=new EventTarget}catch(e){_("Cannot construct EventTarget, cannot support event handler API.",e)}}createPlayerIframe(){const{id:t,options:o,placeholderEl:n}=this;if(n&&n.querySelector(C)&&n.querySelector(".hs-video-wrapper")){_(`Found server-rendered iframe for player ${t}`,o,n);return n.querySelector(".hs-video-wrapper")}_(`Rendering iframe for player ${t}`,o,n);const i="100%"===o.height&&("100%"===o.width||o.full_width);let r="",s="",a=o.style||"",l="";if(i)s=r="position: absolute; width: 100%; height: 100%";else{const t="string"==typeof o.width?Number(o.width):o.width;let n="string"==typeof o.height?Number(o.height):o.height;const i=t&&n?n/t*100:100*e;if("number"==typeof o.maxHeight){n=o.maxHeight;l=`max-height: ${o.maxHeight}px`}let d=t?`max-width: ${t}px; `:"";const c=n&&o.maxHeight&&n>=o.maxHeight?`max-height: ${o.maxHeight}px; `:"";if("boolean"==typeof o.full_width){a||(a="margin: 0 auto;");o.full_width&&(d="")}r=`${d} ${c} ${a}`;s=`position: relative; height: 0; padding-bottom: ${i}%;`}const d=document.createElement("div");d.innerHTML=`\n    <div class="hs-video-container" style="${r.trim()}">\n      <div class="hs-video-wrapper" style="${s.trim()}">\n        <iframe id="hs_player_${t}"\n          loading="lazy"\n          referrerPolicy="origin"\n          sandbox="allow-forms allow-scripts allow-same-origin allow-popups"\n          allow="autoplay; fullscreen;"\n          style="position: absolute !important; width: 100% !important; height: 100% !important; left: 0; top: 0; border: 0 none; pointer-events: initial; ${l}">\n        </iframe>\n      </div>\n    </div>\n  `;return d.firstElementChild}getPlaceholderSelector(){return`[data-hsv-embed-id="${this.id}"]`}findPlaceholderEls(){return O(this.getPlaceholderSelector())}findOtherPlaceholderEls(){return this.findPlaceholderEls().filter((e=>e!==this.placeholderEl&&ht(e)))}selectIframeElFromPage(){const e=O(`iframe#hs_player_${this.id}`);if(e.length>1){_("Found multiple iframes for player",e);pe("Found multiple iframes for player")}return e[0]}confirmRendered(){if(document.contains(this.el))return;if(this.selectIframeElFromPage()){pe("confirmRendered found new iframe el on page via selector.");this.replaceIframeFromPage();return}const e=this.findOtherPlaceholderEls();e.length?pe("confirmRendered found duplicate placeholders for player",{embedId:this.id,otherPlaceholderCount:e.length}):pe("confirmRendered could not find player el and exhausted options to render!")}buildIframeUrl(){const e=De(this.options);return Ve(this.portalId,this.options.id,e,this.id,this.options,this.preloaderIframeLoaded)}isIframeLoaded(){return this.iframeLoaded}getReadyQueue(){return this.outgoingMessages}onMessageReceived(e,o){_(`Received message from player ${this.id}`,e,o);this.receivedMessages.push([e,o]);switch(e){case t.VIDEO_LOADED:this.video=o;this.handleVideoLoaded(this.video);this.trigger(new Event("videoLoaded"));break;case t.PLAYER_LOADED:this.executeReadyQueue();this.placeholderEl.setAttribute("data-hsv-status","loaded");this.timings.loadedAfterMs=ot();this.trigger(new Event("loaded"));break;case t.PLAYER_READY:this.status=r.READY;this.placeholderEl.setAttribute("data-hsv-status","ready");this.timings.readyAfterMs=ot();this.trigger(new Event("ready"));break;case t.PLAYER_PLAY:this.status=r.PLAYING;this.placeholderEl.setAttribute("data-hsv-status","playing");this.timings.playedAfterMs=ot();this.trigger(new Event("play"));break;case t.PLAYER_PROGRESS:if(o&&"object"==typeof o&&"currentTime"in o){const e=o.currentTime,t=new CustomEvent("progress",{detail:{currentTime:e}});this.trigger(t)}break;case t.PLAYER_TIME_UPDATE:if(o&&"object"==typeof o&&"currentTime"in o){const e=o.currentTime,t=new CustomEvent("timeupdate",{detail:{currentTime:e}});this.trigger(t)}break;case t.PLAYER_SECONDS_VIEWED:o&&"object"==typeof o&&"number"==typeof o.secondsViewed&&(this.timings.secondsViewed=o.secondsViewed);break;case t.PLAYER_PAUSE:this.status=r.PAUSED;this.placeholderEl.setAttribute("data-hsv-status","paused");this.trigger(new Event("pause"));break;case t.PLAYER_ENDED:this.status=r.ENDED;this.placeholderEl.setAttribute("data-hsv-status","ended");this.trigger(new Event("ended"));break;case t.PLAYER_SHOW_OVERLAY:{const e=o||this.options.conversionAsset;if(!(e&&e.type&&e.id)){pe("Unexpected PLAYER_SHOW_OVERLAY message");break}this.status=r.CONVERSION_ASSET_OVERLAY;this.placeholderEl.setAttribute("data-hsv-status",`${e.type.toLowerCase()}-overlay`);if(e.type===s.CTA)try{Fe(this,e)}catch(e){pe("Error thrown rendering CTA")}else if(e.type===s.FORM)try{Xe(this,e)}catch(e){pe("Error thrown rendering form")}break}case t.PLAYER_ORPHANED:pe("Player did not receive SET_PAGE_META postMessage",{iframeUrl:this.iframeEl.src});break;case t.PLAYER_ERROR:pe("In-app player reported error",{iframeUrl:this.iframeEl.src});this.trigger(new CustomEvent("error",{detail:o}))}}handleVideoLoaded(e){this.iframeEl.title||(this.iframeEl.title=e.altText||e.title)}triggerPause(){this.postMessageToPlayer(t.SET_PLAYER_STATUS,{status:r.PAUSED})}postMessageToPlayer(e,t=null,o=!0){if(this.iframeLoaded){this.iframeEl.contentWindow||this.replaceIframeFromPage();if(this.iframeEl.contentWindow){this.sendMessage(e,t);return}_(`Could not access contentWindow for player ${this.id}`,e,t)}if(o){_(`Queuing postMessage for player ${this.id}`,e,t);this.outgoingMessages.push([e,t])}}sendMessage(e,o){this.iframeEl.contentWindow||this.replaceIframeFromPage();if(this.iframeEl&&this.iframeEl.contentWindow){_(`Sending postMessage to player ${this.id}`,e,o);o&&"object"==typeof o&&e===t.SET_UTK&&"utk"in o&&(this.utk=o.utk);try{this.iframeEl.contentWindow.postMessage({type:e,payload:o},y(this.options))}catch(e){this.log("Failed to postMessage player",e)}}else _(`sendMessage could not access contentWindow for player ${this.id}`,e,o)}replaceIframe(e){this.iframeEl=e;try{this.intersectionObserver.observe(this.iframeEl)}catch(e){this.onConfirmVisible()}}replaceIframeFromPage(){const e=this.selectIframeElFromPage();if(e){_("Replacing iframeEl from page with ",this.iframeEl,this.iframeEl===e);this.iframeEl=e}}executeReadyQueue(){if(this.outgoingMessages.length){if(this.iframeLoaded){_(`Player ${this.id} reloaded, executing readyQueue of length ${this.outgoingMessages.length}`);if(this.utk){const{utk:e}=this;this.sendMessage(t.SET_UTK,{utk:e})}}else _(`Executing readyQueue of length ${this.outgoingMessages.length} for player ${this.id}`);this.outgoingMessages.forEach((([e,t])=>{this.sendMessage(e,t)}))}this.iframeLoaded=!0}setupIntersectionObserver(){if(U(this.el)){this.initiallyVisible=!0;this.onConfirmVisible()}else{this.intersectionObserver=new IntersectionObserver((e=>{e.forEach((e=>{this.log("IntersectionObserver entry",e);if(e.isIntersecting){this.log("Found player in viewport via IntersectionObserver");this.onConfirmVisible();this.intersectionObserver.disconnect()}}))}),{rootMargin:"100px",threshold:0});this.intersectionObserver.observe(this.el)}}}function gt(e,o){if(e&&e.data&&"object"==typeof e.data&&Object.keys(t).includes(e.data.type)){o&&e.origin&&e.origin!==o&&_("isPlayerMessage saw unexpected origin",e);return!0}return!1}function Et(e,t,{placeholderEl:o}={}){!o&&t.embedId&&((o=k(e,!0))?t.renderContext="embed-id-selector":_(`Failed to find for embedId: ${t.embedId} for player: ${e}`));const n=t.portalId||ge();n&&t.id||pe("Required param `portalId` or video `id` missing");if(we()){t.playerType=l.EDITOR_PREVIEW;t.renderContext="editor-preview"}const i=new mt(e,n,t,o);i.injectPlayer();return i}function yt(e,t){const o=t.portalId||ge(),n=De(t),i=Ve(o,t.id,n,e.id,t);if(t.conversionAsset&&e.options.conversionAsset&&t.conversionAsset.id!==e.options.conversionAsset.id){const t=e.el.querySelector(".hsv-overlay");t&&t.remove()}_(`Updating src of existing iframe for player ${e.id}`,t);e.options=t;e.iframeEl.src=i;t.altText&&(e.iframeEl.title=t.altText);return e}function bt(e,t,o,n=!0){Se(e).forEach((e=>{e.postMessageToPlayer(t,o,n)}))}function vt(e){window.addEventListener("message",(o=>{if(gt(o,y())){const{data:n}=o,{type:i,embedId:s,payload:a={}}=n,l=e[s];if(!l){console.warn(`Could not find embedId ${s}`,n);return}l.onMessageReceived(i,a);if(!(i!==t.PLAYER_PLAY||l.options.autoplay&&a.isInitial)){const t=Se(e).filter((e=>e!==l&&e.status===r.PLAYING));t.length&&_(`Pausing ${t.length} other currently playing players`,t);t.forEach((e=>e.triggerPause()))}if(i===t.PLAYER_ANALYTICS_EVENTS){const e=JSON.parse(a);e.events&&e.events.length&&window._hsq&&e.events.forEach((e=>window._hsq.push(e)))}}}))}function wt(){const e=({id:e})=>{const t=document.querySelector(`.hs-form-${e}.submitted-message`);if(t){const e=pt(t);_(`Found ${e.length} players in form thank you message`);e.forEach((({el:e,options:t})=>{t.renderContext="form-inline-message";window.hsVideoApi.renderPlayer(e,t)}))}};window.addEventListener("message",(t=>{if(t.data&&"hsFormCallback"===t.data.type&&"onFormSubmitted"===t.data.eventName){_("Form submitted",t.data);setTimeout((()=>e(t.data)))}}))}function At(){if(!window.MutationObserver)return null;const e=new MutationObserver((e=>{e.forEach((e=>{if(!e.addedNodes.length)return;const t=[...e.addedNodes].filter((e=>e instanceof Element&&(e.matches(C)||e.matches(L))));e.addedNodes.forEach((e=>{e instanceof Element&&t.push(...e.querySelectorAll(C),...e.querySelectorAll(L))}));if(t.length){_("Found server-rendered iframes via MutationObserver:",t);pe("Found server-rendered iframes via MutationObserver (leaving here for debugging)");t.forEach((e=>{const t=F(e,".hs-video-widget[data-hsv-embed-id]");if(!t||!t.dataset.hsvEmbedId)return;const o=window.hsVideoApi.getPlayer(t.dataset.hsvEmbedId);if(o&&e.matches(L)){_(`Moving player ${t.dataset.hsvEmbedId} to new iframe: `,e);o.replaceIframe(e)}else{const e=ut(t);if(null!=e&&e.embedId){e.renderContext="hubl-iframe";window.hsVideoApi.renderPlayer(t,e)}}}))}}))}));try{e.observe(document.body,{childList:!0,subtree:!0})}catch(e){pe("Failed to create MutationObserver")}return e}function Pt(){document.addEventListener("securitypolicyviolation",(e=>{_("SecurityPolicyViolationEvent event",e);const{blockedURI:t,disposition:o}=e;e.blockedURI&&T.test(t)&&pe(`CSP ${o} blocked video-embed JS`,{blockedURI:t});e.blockedURI&&e.blockedURI.includes(y())&&pe(`CSP ${o} blocked player iframe load`,{blockedURI:t})}))}let _t=1;function It(e="uniq"){return`${e}${_t++}`}let Rt=!1;function Tt({testingMode:e=!1}={}){const o=window._hsq=window._hsq||[],n=window._hsp=window._hsp||[],i=[],r={};let s,a;const l=e=>Boolean(r[e]),d=e=>i.find((([t])=>e===t));function c(...e){let t,o,n;pe("registerPlayer still being called");if("string"==typeof e[0]){t=e[0];o=e[1];o.embedId=t||It()}else if(e[0]instanceof HTMLElement){n=e[0];o=e[1];t=o.embedId||It()}else{if("object"!=typeof e[0]){console.warn("invalid args passed to `registerPlayer`",e);return}o=e[0];t=o.embedId||It()}if(d(t)||l(t))_(`Player with embedId: ${t} already exists, ignoring call to registerPlayer`,o);else{if(N()){!n&&o.embedId&&(n=k(t));if(n){f(n,o);return}}i.push([t,o])}}function u(){return!!s&&(s.categories?s.categories.analytics:s.allowed)}function h(e){bt({[e]:r[e]},t.SET_PAGE_META,Re());a&&u()&&!v()&&bt({[e]:r[e]},t.SET_UTK,{utk:a})}function p(e,t,o){r[e]=Et(e,t,o);v()||h(e);return r[e]}function f(e,t){let o,n;if("string"==typeof e){o=e;n=k(o);if(!n){console.warn(`Element id ${e} not found`);return null}}else{if(!(e instanceof HTMLElement)){console.warn("First argument to renderPlayer must be an id string or HTMLElement");return null}o=t.embedId||It();n=e}if(l(o)){_(`Player with embedId: ${o} already exists, ignoring call to renderPlayer`,t);return null}return p(o,t,{placeholderEl:n})}function m(e,t){const o=w(e);if(!o){_(`Could not find player id ${e} to update`);return null}yt(o,t);return o}function g(e){a=e;if(s&&a)if(u()){_(`Received utk ${a} privacyConsent`,JSON.stringify(s));bt(r,t.SET_UTK,{utk:a})}else{_("Received privacyConsent but not allowed",a,s);bt(r,t.SET_UTK,null)}else _("Could not obtain utk cookie and privacyConsent",a,s)}function y(){n.push(["addPrivacyConsentListener",e=>{s=e;o.push(["addUserTokenListener",g])}])}function b(){return r}function w(e){return b()[e]}function A(){return Se(r).reduce(((e,t)=>{t.receivedMessages.forEach((o=>{e.push([t.id,o[0],o[1]])}));return e}),[])}function I(){Se(r).forEach((e=>e.triggerPause()))}function R(){pt().forEach((({el:e,options:t})=>{if(t.embedId){t.renderContext=j(e,".widget-type-rich_text")?"rich-text-placeholder":"onload-placeholder";Ae()&&(t.renderContext="share-page");p(t.embedId,t,{placeholderEl:e})}}));ft().forEach((({el:e,options:t})=>{if(t.embedId){t.renderContext=Ae()?"hubl-iframe-share-page":"hubl-iframe";p(t.embedId,t,{placeholderEl:e})}}))}function T(){setTimeout((()=>{const e=Object.values(b()).find((e=>e.confirmedVisible));e?_("Not inserting preloader iframe as at least one player is already visible & loading:",e):B((()=>{Object.values(b()).forEach((e=>{e.preloaderIframeLoaded=!0}))}))}),500)}function S(){i.forEach((([e,t])=>{p(e,t)}));vt(r);Rt=!0;if(!v()){T();y();R();Pt();wt();At();window._hsVideoReady&&Array.isArray(window._hsVideoReady)&&setTimeout((()=>window._hsVideoReady.forEach((e=>e()))))}}if(Rt&&!e)_("loader already initialized, not listening for document load");else if(N())try{S()}catch(e){fe(e,{source:"already-loaded"})}else{document.addEventListener("DOMContentLoaded",(()=>{try{S()}catch(e){fe(e,{source:"DOMContentLoaded"})}}));window.addEventListener("content-analytics-code-not-loaded",(()=>g(null)))}const C={registerPlayer:c,renderPlayer:f,updatePlayer:m,getPlayer:w,getPlayers:()=>Se(b()),getPerformanceMetrics:()=>it(Object.values(r)),pauseAllPlayers:I};return e||P()||E()?Object.assign({},C,{getPlayerMessages:A,triggerLoad:S,renderPlaceholders:R}):C}let St=window.hsVideoApi;St?_("hsVideoApi found on page, not calling createLoader"):window.hsVideoApi=St=Tt();St.renderPlayer,St.updatePlayer}();
//# sourceMappingURL=//static.hsappstatic.net/video-embed/static-1.21588/bundles/loader.js.map